#!/usr/bin/env perl
################################################################################
# WeBWorK Online Homework Delivery System
# Copyright © 2000-2003 The WeBWorK Project, http://openwebwork.sf.net/
# $CVSHeader: webwork2/bin/wwsh,v 1.5 2004/01/03 21:00:28 sh002i Exp $
# 
# This program is free software; you can redistribute it and/or modify it under
# the terms of either: (a) the GNU General Public License as published by the
# Free Software Foundation; either version 2, or (at your option) any later
# version, or (b) the "Artistic License" which comes with this package.
# 
# This program is distributed in the hope that it will be useful, but WITHOUT
# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
# FOR A PARTICULAR PURPOSE.  See either the GNU General Public License or the
# Artistic License for more details.
################################################################################

=head1 NAME

wwdb - command-line interface to the WeBWorK libraries.

=cut

use strict;
use warnings;

BEGIN {
	die "WEBWORK_ROOT not found in environment.\n"
		unless exists $ENV{WEBWORK_ROOT};
}

use lib "$ENV{WEBWORK_ROOT}/lib";
use PSH;
use WeBWorK::CourseEnvironment;
use WeBWorK::DB;

my ($course, $cmd) = @ARGV;

unless ($course) {
	die "usage: $0 course\n";
}

our $ce = WeBWorK::CourseEnvironment->new($ENV{WEBWORK_ROOT}, "", "", $course);
our $db = WeBWorK::DB->new($ce->{dbLayout});
(undef) = $db; # placate warnings

if ($cmd) {
	no warnings;
	no strict;
	eval $cmd;
	die $@ if $@;
	use strict;
	use warnings;
} else {
	print <<'EOF';
wwsh - The WeBWorK Shell
Available objects: $ce (WeBWorK::CourseEnvironment)
                   $db (WeBWorK::DB)
EOF
	PSH::prompt();
}
