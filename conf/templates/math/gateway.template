<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
################################################################################
# WeBWorK Online Homework Delivery System
# Copyright Â© 2000-2003 The WeBWorK Project, http://openwebwork.sf.net/
# $CVSHeader: webwork2/conf/templates/math/gateway.template,v 1.9 2006/08/03 15:16:47 glarose Exp $
# 
# This program is free software; you can redistribute it and/or modify it under
# the terms of either: (a) the GNU General Public License as published by the
# Free Software Foundation; either version 2, or (at your option) any later
# version, or (b) the "Artistic License" which comes with this package.
# 
# This program is distributed in the hope that it will be useful, but WITHOUT
# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
# FOR A PARTICULAR PURPOSE.  See either the GNU General Public License or the
# Artistic License for more details.
################################################################################
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta http-equiv="Pragma" content="no-cache"/>
<meta http-equiv="expires" content="Wed, 21 Dec 2005 00:00:01 GMT"/>
<link rel="stylesheet" type="text/css" href="<!--#url type="webwork" name="htdocs"-->/css/math.css"/>
<!-- [gateway] since the left-side menus are gone, don't indent the main content area -->
<link rel="stylesheet" type="text/css" href="<!--#url type="webwork" name="htdocs"-->/css/gateway.css"/>
<title><!--#path style="text" text=" : " textonly="1"--></title>
<!--#head-->
<script language="javascript" type="text/javascript">
function jumpTo(ref) {  // scrolling javascript function
    if ( ref ) {
        var pn = ref - 1; // we start anchors at 1, not zero
        if ( navigator.appName == "Netscape" && 
             parseFloat(navigator.appVersion) < 5 ) {
            var xpos = document.anchors[pn].x;
            var ypos = document.anchors[pn].y;
        } else {
            var xpos = document.anchors[pn].offsetLeft;
            var ypos = document.anchors[pn].offsetTop;
        }
        if ( window.scrollTo == null ) { // cover for anyone
            window.scroll(xpos,ypos);    //   lacking js1.2
        } else {
            window.scrollTo(xpos,ypos);
        }
    }
    return false; // prevent link from being followed
}

// timer for gateway 
var theTimer;		// variable for the timer
var browserTime;	// on load, the time on the client's computer
var serverTime;		// on load, the time on the server
var timeDelta;		// the difference between those
var serverDueTime;	// the time the test is due

function runtimer() {
// function to start the timer, initializing the time variables
    if ( document.getElementById('gwTimer') == null ) {  // no timer
	return;
    } else {
	theTimer = document.getElementById('gwTimer');
	var dateNow = new Date();
	browserTime = Math.round(dateNow.getTime()/1000);
	serverTime = document.gwTimeData.serverTime.value;
	serverDueTime = document.gwTimeData.serverDueTime.value;
	timeDelta = browserTime - serverTime;

	var remainingTime = serverDueTime - browserTime + 1.*timeDelta;

	if ( remainingTime >= 0 ) {
	    theTimer.innerHTML = "Remaining time: " + toMinSec(remainingTime) + " (min:sec)";
	    setTimeout("updateTimer();", 1000);
	    setTimeout("checkAlert();", 1000);
	} else {
	    theTimer.innerHTML = "Remaining time: 0 min";
	}

    // one last check for i.e., which can't do position: fixed
	if ( navigator.appName != "Netscape" &&
	     parseFloat(navigator.appVersion) < 7 ) {
	    theTimer.style.position = "absolute";
	}
    }
}

function updateTimer() {
// update the timer 
    var dateNow = new Date();
    browserTime = Math.round(dateNow.getTime()/1000);
    var remainingTime = serverDueTime - browserTime + 1.*timeDelta;
    if ( remainingTime >= 0 ) {
	theTimer.innerHTML = "Remaining time: " + toMinSec(remainingTime) + " (min:sec)";
	setTimeout("updateTimer();", 1000);
    }
}

function checkAlert() { 
// check to see if we should put up a low time alert
    var dateNow = new Date();
    browserTime = Math.round(dateNow.getTime()/1000);
    var timeRemaining = serverDueTime - browserTime + 1.*timeDelta;

    if ( timeRemaining <= 0 ) {
        alert("* You are out of time! *\n" + 
	      "* Press grade now!     *");
    } else if ( timeRemaining <= 45 && timeRemaining > 40 ) {
	alert("* You have less than 45 seconds left! *\n" + 
	      "*      Press Grade very soon!         *");
    } else if ( timeRemaining <= 90 && timeRemaining > 85 ) {
	alert("* You only have less than 90 sec left to complete  *\n" + 
	      "* this assignment. You should finish it very soon! *");
    }
    if ( timeRemaining > 0 ) {
	setTimeout("checkAlert();", 5000);
    }
}

function toMinSec(t) {
// convert to min:sec
    if ( t < 0 ) {     // don't deal with negative times
	t = 0;
    }
    mn = Math.floor(t/60);
    sc = t - 60*mn;
    if ( mn < 10 && mn > -1 ) {
        mn = "0" + mn;
    }
    if ( sc < 10 ) {
        sc = "0" + sc;
    }
    return mn + ":" + sc;
}

// for some reason putting this as an onload event in the body tag
// isn't working.  so start the timer here; the 500ms delay is to be 
// sure that the timer has loaded
setTimeout("runtimer()",500);
// this does not work either
// window.onload=runtimer();
</script>
</head>
<body bgcolor="white">
<div id="masthead">
	<div id="loginstatus">
		<!--#loginstatus-->
	</div>
	<div id="logo">
		<img src="<!--#url type="webwork" name="htdocs"-->/images/webwork_rectangle.png" alt="WeBWorK" height="51" width="267" />
	</div>
</div>
<hr class="for-broken-browsers"/>
<div id="big-wrapper">
	<div id="breadcrumbs">
		<!--#path style="text" text=" &#x2192; "-->
	</div>
	<div id="content">
		
		<!--#if can="info"-->
		<!--<div id="page-info">-->
			<!--<div class="info-box" id="fisheye">-->
				<!--#info-->
			<!--</div>-->
		<!--</div>-->
		<!--#endif-->
		
		<!-- [gateway] removed nav button to go up -->
		
		<!--#if can="title"-->
		<h1><!--#title--></h1>
		<!--#endif-->
		
		<!--#if can="message"-->
			<div class="Message">
				<!--#message-->
			</div>
		<!--#endif-->

		<!--#if can="body"-->
		<div class="Body">
			<!--#body-->
		</div>
		<!--#endif-->
		
		<!--#if warnings="1"-->
		<hr>
		<div class="Warnings">
			<!--#warnings-->
		</div>
		<!--#endif-->
		
		<!--#if can="message"-->
			<div class="Message">
				<!--#message-->
			</div>
		<!--#endif-->
		
	</div> <!-- content -->
	<hr class="for-broken-browsers"/>
	<div id="footer">
		<p id="last-modified">Page generated at <!--#timestamp--></p>
		<div id="copyright">
			WeBWorK &#169; 2000-2006 <a href="http://openwebwork.sf.net/">The WeBWorK Project</a>
		</div>
	</div>
	<!-- [gateway] removed left sidebar -->
</div> <!-- big-wrapper -->

</body>
</html>
