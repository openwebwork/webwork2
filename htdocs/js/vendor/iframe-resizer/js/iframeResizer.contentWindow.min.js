/*! iFrame Resizer (iframeSizer.contentWindow.min.js) - v3.0.0 - 2015-08-04
 *  Desc: Include this file in any page being loaded into an iframe
 *        to force the iframe to resize to the content size.
 *  Requires: iframeResizer.min.js on host page.
 *  Copyright: (c) 2015 David J. Bradshaw - dave@bradshaw.net
 *  License: MIT
 */

!function(a){"use strict";function b(b,c,d){"addEventListener"in a?b.addEventListener(c,d,!1):"attachEvent"in a&&b.attachEvent("on"+c,d)}function c(a){return _+"["+bb+"] "+a}function d(b){$&&"object"==typeof a.console&&console.log(c(b))}function e(b){"object"==typeof a.console&&console.warn(c(b))}function f(){g(),d("Initialising iFrame ("+location.href+")"),h(),k(),j("background",L),j("padding",O),s(),p(),q(),l(),u(),r(),Y=t(),D("init","Init message from host page")}function g(){function a(a){return"true"===a?!0:!1}var b=X.substr(ab).split(":");bb=b[0],M=void 0!==b[1]?Number(b[1]):M,P=void 0!==b[2]?a(b[2]):P,$=void 0!==b[3]?a(b[3]):$,Z=void 0!==b[4]?Number(b[4]):Z,J=void 0!==b[6]?a(b[6]):J,N=b[7],V=void 0!==b[8]?b[8]:V,L=b[9],O=b[10],gb=void 0!==b[11]?Number(b[11]):gb,Y.enable=void 0!==b[12]?a(b[12]):!1,db=void 0!==b[13]?b[13]:db,lb=void 0!==b[14]?b[14]:lb}function h(){function b(){var b=a.iFrameResizer;d("Reading data from page: "+JSON.stringify(b)),mb=void 0!==b.messageCallback?b.messageCallback:mb,eb=void 0!==b.targetOrigin?b.targetOrigin:eb,V=void 0!==b.heightCalculationMethod?b.heightCalculationMethod:V,lb=void 0!==b.widthCalculationMethod?b.widthCalculationMethod:lb}"iFrameResizer"in a&&Object===a.iFrameResizer.constructor&&b()}function i(a,b){return-1!==b.indexOf("-")&&(e("Negative CSS value ignored for "+a),b=""),b}function j(a,b){void 0!==b&&""!==b&&"null"!==b&&(document.body.style[a]=b,d("Body "+a+' set to "'+b+'"'))}function k(){void 0===N&&(N=M+"px"),i("margin",N),j("margin",N)}function l(){document.documentElement.style.height="",document.body.style.height="",d('HTML & body height set to "auto"')}function m(c){function e(d){function e(){D(c.eventName,c.eventType)}b(a,d,e)}c.eventNames&&Array.prototype.map?(c.eventName=c.eventNames[0],c.eventNames.map(e)):e(c.eventName),d("Added event listener: "+c.eventType)}function n(){m({eventType:"Animation Start",eventNames:["animationstart","webkitAnimationStart"]}),m({eventType:"Animation Iteration",eventNames:["animationiteration","webkitAnimationIteration"]}),m({eventType:"Animation End",eventNames:["animationend","webkitAnimationEnd"]}),m({eventType:"Orientation Change",eventName:"orientationchange"}),m({eventType:"Input",eventName:"input"}),m({eventType:"Print",eventName:["afterprint","beforeprint"]}),m({eventType:"Transition End",eventNames:["transitionend","webkitTransitionEnd","MSTransitionEnd","oTransitionEnd","otransitionend"]}),m({eventType:"Mouse Up",eventName:"mouseup"}),"child"===db&&m({eventType:"IFrame Resized",eventName:"resize"})}function o(a,b,c,f){b!==a&&(a in c||(e(a+" is not a valid option for "+f+"CalculationMethod."),a=b),d(f+' calculation method set to "'+a+'"'))}function p(){o(V,U,nb,"height")}function q(){o(lb,kb,ob,"width")}function r(){!0===J?(n(),x()):d("Auto Resize disabled")}function s(){var a=document.createElement("div");a.style.clear="both",a.style.display="block",document.body.appendChild(a)}function t(){function c(){return{x:void 0!==a.pageXOffset?a.pageXOffset:document.documentElement.scrollLeft,y:void 0!==a.pageYOffset?a.pageYOffset:document.documentElement.scrollTop}}function f(a){var b=a.getBoundingClientRect(),d=c();return{x:parseInt(b.left,10)+parseInt(d.x,10),y:parseInt(b.top,10)+parseInt(d.y,10)}}function g(a){function b(a){var b=f(a);d("Moving to in page link (#"+c+") at x: "+b.x+" y: "+b.y),H(b.y,b.x,"scrollToOffset")}var c=a.split("#")[1]||a,e=decodeURIComponent(c),g=document.getElementById(e)||document.getElementsByName(e)[0];g?b(g):(d("In page link (#"+c+") not found in iFrame, so sending to parent"),H(0,0,"inPageLink","#"+c))}function h(){""!==location.hash&&"#"!==location.hash&&g(location.href)}function i(){function a(a){function c(a){a.preventDefault(),g(this.getAttribute("href"))}"#"!==a.getAttribute("href")&&b(a,"click",c)}Array.prototype.forEach.call(document.querySelectorAll('a[href^="#"]'),a)}function j(){b(a,"hashchange",h)}function k(){setTimeout(h,R)}function l(){Array.prototype.forEach&&document.querySelectorAll?(d("Setting up location.hash handlers"),i(),j(),k()):e("In page linking not fully supported in this browser! (See README.md for IE8 workaround)")}return Y.enable?l():d("In page linking not enabled"),{findTarget:g}}function u(){d("Enable public methods"),a.parentIFrame={close:function(){H(0,0,"close")},getId:function(){return bb},moveToAnchor:function(a){Y.findTarget(a)},reset:function(){G("parentIFrame.reset")},scrollTo:function(a,b){H(b,a,"scrollTo")},scrollToOffset:function(a,b){H(b,a,"scrollToOffset")},sendMessage:function(a,b){H(0,0,"message",JSON.stringify(a),b)},setHeightCalculationMethod:function(a){V=a,p()},setWidthCalculationMethod:function(a){lb=a,q()},setTargetOrigin:function(a){d("Set targetOrigin: "+a),eb=a},size:function(a,b){var c=""+(a?a:"")+(b?","+b:"");E(),D("size","parentIFrame.size("+c+")",a,b)}}}function v(){0!==Z&&(d("setInterval: "+Z+"ms"),setInterval(function(){D("interval","setInterval: "+Z)},Math.abs(Z)))}function w(a){return void 0===a||0===a}function x(){function b(a){function b(a){var b=D.bind(null,"imageLoad","Image loaded",void 0,void 0);(w(a.height)||w(a.width))&&(d("Attach listerner to "+a.src),a.addEventListener("load",b,!1))}"attributes"===a.type&&"src"===a.attributeName?b(a.target):"childList"===a.type&&Array.prototype.forEach.call(a.target.querySelectorAll("img"),b)}function c(a){D("mutationObserver","mutationObserver: "+a[0].target+" "+a[0].type),b(a[0])}function f(){var a=document.querySelector("body"),b={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0},e=new h(c);d("Enable MutationObserver"),e.observe(a,b)}var g=0>Z,h=a.MutationObserver||a.WebKitMutationObserver;h?g?v():f():(e("MutationObserver not supported in this browser!"),v())}function y(a){function b(a){var b=/^\d+(px)?$/i;if(b.test(a))return parseInt(a,K);var d=c.style.left,e=c.runtimeStyle.left;return c.runtimeStyle.left=c.currentStyle.left,c.style.left=a||0,a=c.style.pixelLeft,c.style.left=d,c.runtimeStyle.left=e,a}var c=document.body,d=0;return"defaultView"in document&&"getComputedStyle"in document.defaultView?(d=document.defaultView.getComputedStyle(c,null),d=null!==d?d[a]:0):d=b(c.currentStyle[a]),parseInt(d,K)}function z(a,b){for(var c=b.length,e=0,f=(new Date).getTime(),g=0;c>g;g++)b[g].getBoundingClientRect()[a]>e&&(e=b[g].getBoundingClientRect()[a]);return f=(new Date).getTime()-f,d("Parsed "+c+" HTML elements"),d("Element position calculated in "+f+"ms"),e}function A(a){return[a.bodyOffset(),a.bodyScroll(),a.documentElementOffset(),a.documentElementScroll()]}function B(a,b){function c(){return e("No tagged elements ("+b+") found on page"),T}var d=document.querySelectorAll("["+b+"]");return 0===d.length?c():z(a,d)}function C(){return document.querySelectorAll("body *")}function D(a,b,c,e){function f(){a in{reset:1,resetPage:1,init:1}||d("Trigger event: "+b)}function g(){T=n,jb=o,H(T,jb,a)}function h(){return hb&&a in Q}function i(){function a(a,b){var c=Math.abs(a-b)<=gb;return!c}return n=void 0!==c?c:nb[V](),o=void 0!==e?e:ob[lb](),a(T,n)||P&&a(jb,o)}function j(){return!(a in{init:1,interval:1,size:1})}function k(){return V in cb||P&&lb in cb}function l(){d("No change in size detected")}function m(){j()&&k()?G(b):a in{interval:1}||(f(),l())}var n,o;h()?d("Trigger event cancelled: "+a):i()||"init"===a?(f(),E(),g()):m()}function E(){hb||(hb=!0,d("Trigger event lock on")),clearTimeout(ib),ib=setTimeout(function(){hb=!1,d("Trigger event lock off"),d("--")},R)}function F(a){T=nb[V](),jb=ob[lb](),H(T,jb,a)}function G(a){var b=V;V=U,d("Reset trigger event: "+a),E(),F("reset"),V=b}function H(a,b,c,e,f){function g(){void 0===f?f=eb:d("Message targetOrigin: "+f)}function h(){var g=a+":"+b,h=bb+":"+g+":"+c+(void 0!==e?":"+e:"");d("Sending message to host page ("+h+")"),fb.postMessage(_+h,f)}g(),h()}function I(b){function c(){return _===(""+b.data).substr(0,ab)}function g(){X=b.data,fb=b.source,f(),S=!1,setTimeout(function(){W=!1},R)}function h(){W?d("Page reset ignored by init"):(d("Page size reset by host page"),F("resetPage"))}function i(){D("resizeParent","Parent window requested size check")}function j(){var a=l();Y.findTarget(a)}function k(){return b.data.split("]")[1].split(":")[0]}function l(){return b.data.split(":")[1]}function m(){return"iFrameResize"in a}function n(){var a=l();d("MessageCallback called from parent: "+a),mb(JSON.parse(a)),d(" --")}function o(){return b.data.split(":")[2]in{"true":1,"false":1}}function p(){switch(k()){case"reset":h();break;case"resize":i();break;case"moveToAnchor":j();break;case"message":n();break;default:m()||o()||e("Unexpected message ("+b.data+")")}}function q(){!1===S?p():o()?g():d('Ignored message of type "'+k()+'". Received before initialization.')}c()&&q()}var J=!0,K=10,L="",M=0,N="",O="",P=!1,Q={resize:1,click:1},R=128,S=!0,T=1,U="bodyOffset",V=U,W=!0,X="",Y={},Z=32,$=!1,_="[iFrameSizer]",ab=_.length,bb="",cb={max:1,min:1,bodyScroll:1,documentElementScroll:1},db="child",eb="*",fb=a.parent,gb=0,hb=!1,ib=null,jb=1,kb="max",lb=kb,mb=function(){e("MessageCallback function not defined")},nb={bodyOffset:function(){return document.body.offsetHeight+y("marginTop")+y("marginBottom")},offset:function(){return nb.bodyOffset()},bodyScroll:function(){return document.body.scrollHeight},documentElementOffset:function(){return document.documentElement.offsetHeight},documentElementScroll:function(){return document.documentElement.scrollHeight},max:function(){return Math.max.apply(null,A(nb))},min:function(){return Math.min.apply(null,A(nb))},grow:function(){return nb.max()},lowestElement:function(){return Math.max(nb.bodyOffset(),z("bottom",C()))},taggedElement:function(){return B("bottom","data-iframe-height")}},ob={bodyScroll:function(){return document.body.scrollWidth},bodyOffset:function(){return document.body.offsetWidth},documentElementScroll:function(){return document.documentElement.scrollWidth},documentElementOffset:function(){return document.documentElement.offsetWidth},scroll:function(){return Math.max(ob.bodyScroll(),ob.documentElementScroll())},max:function(){return Math.max.apply(null,A(ob))},min:function(){return Math.min.apply(null,A(ob))},leftMostElement:function(){return z("left",C())},taggedElement:function(){return B("left","data-iframe-width")}};b(a,"message",I)}(window||{});
//# sourceMappingURL=iframeResizer.contentWindow.map